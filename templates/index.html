{% extends "base.html" %}
{% load static %}
{% load humanize %}
{% block content %}
    {% if user.player.isActivated and not user.player.inDiscord %}
        <div style="text-align:center">
            <h3>! Discord サーバー参加へのお願い !</h3>
            <p>
                あなたはまだ JBSL の Discord サーバーに参加していません。
            </p>
            <p>
                以下のリンクから参加お願いします。
            </p>
            <p>
                <span class="dl_link"><a href="https://discord.gg/CqQ6ZD8KRn">参加</a></span>
            </p>
        </div>
    {% endif %}
    {% for league in invitations %}
        <div style="text-align:center">
            <h3>
                ! リーグ <span style="color:{{ league.color }}">{{ league }}</span> から招待が届いています !
                <form method="post">
                    {% csrf_token %}
                    <button class="btn" type="submit" name="join" value="{{ league.pk }}">参加</button>
                    <button class="danger"
                            style="transform:scale(0.7);"
                            type="submit"
                            name="decline"
                            value="{{ league.pk }}">拒否</button>
                </form>
            </h3>
        </div>
    {% endfor %}
    {% if not user.is_authenticated %}
        <h3>参加方法</h3>
        <ul>
            <li>右上の「Discord 認証」から仮登録を完了してください。</li>
            <li>登録には Discord のアカウントが必要となります。</li>
            <li>
                Discord 認証時、<u>最初の 1 回はエラーが出るようです。</u>（原因不明です。すいません）
            </li>
            <li>その場合、ブラウザの「戻る」ボタンを使ってリトライお願いします。</li>
            <li>仮登録後、ScoreSaber のIDを設定することにより、本登録となります。</li>
            <li>
                登録できるのは<u>日本人プレイヤーのみ</u>となります。Sorry, only Japanese players can be registered.
            </li>
        </ul>
    {% endif %}
    <div style="text-align:center">
        <h3>! 第 4 回 JBSL 開催決定 !</h3>
        <ul>
            <p>
                9月24日（土） マッパー募集開始
            </p>
            <p>
                10月9日（日） マッパー募集締切
            </p>
            <p>
                10月22日（土）～10月30日（日） J3,J2 予選
            </p>
            <p>
                10月29日（土）～11月6日（日） J1 予選
            </p>
            <p>
                11月12日（土） J3 本戦
            </p>
            <p>
                11月13日（日） J2 本戦
            </p>
            <p>
                11月19日（土） J1 本戦・前半
            </p>
            <p>
                11月26日（土） J1 本戦・後半
            </p>
        </ul>
        <h3>
            現在、<a href="https://docs.google.com/forms/d/1yUseuJwNCr_5enc5VPN-IB4AJql21KSL7VJ4hrRh_Eg/"
   style="color:#ff8628">マッパー募集中</a>（10 月9日　〆）です！
        </h3>
    </div>
    <h3>JBSL4前座企画　マッパー杯</h3>
<p>
<p><img src="https://cdn.discordapp.com/avatars/435010295899881473/bd2ff5ff1fc7ab364ff29c6a8a54d9f9"></p>
<p>マッパー杯 Part1 <a href="https://jbsl-web.herokuapp.com/leaderboard/28" style="color:#ff8628">hibit杯</a> 開催中！（～10月2日）</p>
<p>マッパーさんからコメントをいただいております。</p>
<pre>
・春を告げる

yamaさんのシンセが死ぬほどかっこいい曲。
シンセのかっこよさを表現することを意識しました。
ノリノリで切って欲しい。

・お砂糖ふたつ

個人的にビーセイ用の曲を提供してくれたり、ビー祭用の曲も提供してくれている「よじしょー」君の作品。
私の作品にはめずらしい、ゆるいテックな感じです。
今回のラインナップの中ではいちばん簡単。

・さよならアンドロメタ

おしゃれな曲。JBSL に出させていただきましたが、採用されたのは HARD の方なので、こっち（EXPERT）はやったことない人が多いんじゃないかな。
サビで一気に世界観が変わる感じを表現したくて、サビの配置をほぼすべて斜めノーツにするという暴挙に出ました。

・Blood Sunburst

後世では「令和の特異点」とも呼ばれる稀代の作曲家 hibit 氏の作品を譜面化しました。
あらびあーんな感じを意識して作りました。
褐色の少女が砂漠で佇んでる景色を想像してください。

・メリーさん

ギターが超かっこいい曲。全ては後半の DD がやりたくてやった感じがある。

・前衛的ランドスケープ

Lapix さんの超かっこいい曲。JBSL に出させていただきました。
シンセがかっこいい曲っていいよね。

・「i」

可不ちゃんのフォニィのオマージュ？的な作品。サビを聞いた瞬間に配置が思い浮かんで、超いい感じの譜面になりました。
Curate もしていただいた自信作です。
</pre>    
</p>
    <h3>Headlines</h3>
    {% for headline in headlines %}
        <ul>
            <li>
                {% if headline.player != None %}
                    <a href="{% url 'app:userpage' sid=headline.player.sid %}">
                        <img src="{{ headline.player.imageURL }}" class="icon" />
                    </a> {{ headline.text }} （{{ headline.time }}）
                {% else %}
                    {{ headline.text }}
                {% endif %}
            </li>
        </ul>
    {% endfor %}
    <p>
        <a href="{% url 'app:headlines' page=1 %}">...More Headlines</a>
    </p>
    <h3>Live Leagues</h3>
    <table class="table table-striped table-borderless"
           style="background-color:gray">
        <thead>
            <th>Cover</th>
            <th>Title</th>
            <th>Description</th>
            <th>Limit</th>
            <th>Owner</th>
            <th>End</th>
            <th>1st</th>
            <th>2nd</th>
            <th>3rd</th>
        </thead>
        {% for league in active_leagues %}
            <tr style="background-color:{{ league.color }}">
                <td>
                    <a href={% url 'app:leaderboard' pk=league.pk %}>
                        <img class="thumb" src=" {{ league.playlist.image }}" />
                    </a>
                </td>
                <td>{{ league.name }}</td>
                <td>{{ league.description|truncatechars:50 }}</td>
                <td>
                    {% if league.isPublic %}
                        {% if league.limit == 2000 %}
                            上限なし
                        {% else %}
                            {{ league.limit }}
                        {% endif %}
                    {% else %}
                        Private
                    {% endif %}
                </td>
                <td>
                    <a href
                       {% url 'app:userpage' sid=league.owner.sid %}
                       style="color:black">{{ league.owner.name }}</a>
                </td>
                <td>
                    {{ league.end }}
                </td>
                <td>
                    {% if league.first != None %}
                        <a href="{% url 'app:userpage' sid=league.first.sid %}"
                           style="color:black">
                            {% with league.first as player %}
                                <img class="icon" src={{ player.imageURL }}>
                                <br>
                                {% if player.isSupporter %}
                                    <span style="color:{{ player.userColor }}; font-weight:bold; {% if player.isShadow %}filter: drop-shadow(0 0 3px {{ player.bgColor }});{% endif %} ">{{ player.name }}</span>
                                {% else %}
                                    {{ player.name }}
                                {% endif %}
                            {% endwith %}
                        </a>
                    {% endif %}
                </td>
                <td>
                    {% if league.second != None %}
                        <a href="{% url 'app:userpage' sid=league.second.sid %}"
                           style="color:black">
                            {% with league.second as player %}
                                <img class="icon" src={{ player.imageURL }}>
                                <br>
                                {% if player.isSupporter %}
                                    <span style="color:{{ player.userColor }}; font-weight:bold; {% if player.isShadow %}filter: drop-shadow(0 0 3px {{ player.bgColor }});{% endif %} ">{{ player.name }}</span>
                                {% else %}
                                    {{ player.name }}
                                {% endif %}
                            {% endwith %}
                        </a>
                    {% endif %}
                </td>
                <td>
                    {% if league.third != None %}
                        <a href="{% url 'app:userpage' sid=league.third.sid %}"
                           style="color:black">
                            {% with league.third as player %}
                                <img class="icon" src={{ player.imageURL }}>
                                <br>
                                {% if player.isSupporter %}
                                    <span style="color:{{ player.userColor }}; font-weight:bold; {% if player.isShadow %}filter: drop-shadow(0 0 3px {{ player.bgColor }});{% endif %} ">{{ player.name }}</span>
                                {% else %}
                                    {{ player.name }}
                                {% endif %}
                            {% endwith %}
                        </a>
                    {% endif %}
                </td>
            </tr>
        {% endfor %}
    </table>
{% endblock %}
