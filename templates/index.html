{% extends "base.html" %}
{% load static %}
{% load humanize %}
{% block content %}
    {% if user.player.isActivated and not user.player.inDiscord %}
        <div style="text-align:center">
            <h3>! Discord サーバー参加へのお願い !</h3>
            <p>
                あなたはまだ JBSL の Discord サーバーに参加していません。
            </p>
            <p>
                以下のリンクから参加お願いします。
            </p>
            <p>
                <span class="dl_link"><a href="https://discord.gg/CqQ6ZD8KRn">参加</a></span>
            </p>
        </div>
    {% endif %}
    {% for league in invitations %}
        <div style="text-align:center">
            <h3>
                ! リーグ <a href="{% url 'app:leaderboard' pk=league.pk %}" style="color:{{ league.color }}">{{ league }}</a> から招待が届いています !
                <form method="post">
                    {% csrf_token %}
                    <button class="btn" type="submit" name="join" value="{{ league.pk }}">参加</button>
                    <button class="btn"
                            style="background-color:red"
                            type="submit"
                            name="decline"
                            value="{{ league.pk }}">拒否</button>
                </form>
            </h3>
        </div>
    {% endfor %}
    {% if not user.is_authenticated %}
        <h3>参加方法</h3>
        <ul>
            <li>右上の「Discord 認証」から仮登録を完了してください。</li>
            <li>登録には Discord のアカウントが必要となります。</li>
            <li>
                Discord 認証時、<u>最初の 1 回はエラーが出るようです。</u>（原因不明です。すいません）
            </li>
            <li>その場合、ブラウザの「戻る」ボタンを使ってリトライお願いします。</li>
            <li>仮登録後、ScoreSaber のIDを設定することにより、本登録となります。</li>
            <li>
                登録できるのは<u>日本人プレイヤーのみ</u>となります。Sorry, only Japanese players can be registered.
            </li>
        </ul>
    {% endif %}
    <h3>JBSL4前座企画　マッパー杯</h3>
    <p>
        <p>
            <img src="https://cdn.scoresaber.com/avatars/76561199033287640.jpg"
                 width="128px"
                 height="128px">
        </p>
        <p>
            マッパー杯 Part4 <a href="https://jbsl-web.herokuapp.com/leaderboard/32"
    style="color:#ff8628">komeijisan 杯</a> 開催中！（～10月16日）
        </p>
        <p>
            マッパーさんからコメントをいただいております。
        </p>
        <pre>
        ・KatagiriRekka - Answer Ex
        これ本当に古明地さん？って疑われる譜面です(´・ω・｀)
        
        ・USAO ＆ DJ Genki feat.Rune - Ouverture　Ex+
        ボムと壁が多い譜面です。Wacca終わって悲しい(´・ω・｀)
        
        ・BlackY feat. Risa Yuzuki - Loschen　Ex+
        ゆずりさはいいぞぉ
        
        ・Kobaryo - Invisible Frenzy　Ex+
        何故先にリミックスの方を作ってしまったのか…(´・ω・｀)
        
        ・Camellia - WE ARE NOT CURZED　Ex+
        曲がとてもかっこいいです。
        
        ・Hyun - Duplicity Shade(Feat. Sennzai)　Ex+
        私だって合作もしますよ？
        
        ・seatrus - E　Ex+
        私の譜面の中でトップ5に入る難しさです
</pre>
    </p>
    <p>
        <p>
            <img src="https://cdn.scoresaber.com/avatars/76561199157895190.jpg" height="128px" width="128px">
        </p>
        <p>
            マッパー杯 Part5 <a href="https://jbsl-web.herokuapp.com/leaderboard/33"
    style="color:#ff8628">qwer杯</a> 開催中！（～10月16日）
        </p>
        <p>
            マッパーさんからコメントをいただいております。
        </p>
        <pre>
        !bsr 17873　Merry Christmas Mr.Lawrence　Expert
        qwerの処女作。私がEXを作り古明地さんがEX＋を作ってくれました
        とても好きな曲なのでビーセイでやりたかった・・・！
        癖のない譜面目指したつもりでしたが結構癖が強いらしい
        
        !bsr 19494　PEACE BREAKER　Hard
        こちらも古明地さんとの合作です　Hard(qwer Hard?)とEX+(qwer vibroMAX)を担当しました
        コンボ数がモリモリ増えます　腕に自信のある方はEX、EX+にもチャレンジしてみてほしい
        
        !bsr 1dde2　ja-nay　Hard
        ダンスマップを作ってみたかった！おすすめはEXより断然Hard！
        楽しく踊ってもらえるとうれしい
        
        !bsr 20356　Mario Paint (Time Regression Mix)　Expert+
        体を大きく動かす配置を目指しました
        体を傾けて大きく振ってください
        左右反転地帯がありますが慣れれば楽しいはずです・・・？
        
        !bsr 24196　you　Expert
        ひぐらしのなく頃にのyouになります
        JBSL用として特殊枠で舞える譜面として作りました
        斬りずらいかもとは思いましたがなかなか好評だったようでよかったです
        
        !bsr 26aed　楽しい幼稚園　Expert+
        ネタ用に作った譜面です
        一度はやってみたい配置を詰め込みました！
        
        !bsr 29cae　機械人形　Expert+
        電気式華憐音楽集団（デンカレ）の機械人形です
        平面ストリーム中心の譜面です！
        ストリーム部分は皆から案を出してもらった配置を組み込んでいます
        正直難しいですけどチャレンジしてほしい！
</pre>
    </p>
    <p>
        <p>
            <img src="https://cdn.scoresaber.com/avatars/76561198841939755.jpg" height="128px" width="128px">
        </p>
        <p>
            マッパー杯 Part6 <a href="https://jbsl-web.herokuapp.com/leaderboard/34"
    style="color:#ff8628">Fara杯</a> 開催中！（～10月16日）
        </p>
        <p>
            マッパーさんからコメントをいただいております。
        </p>
        <pre>
        Shōjo Kanaria to Rengoku - fuku_wa Ver - (Ex+)
        テック練習のために作者が好き放題置いた譜面。
        
        Beat Gather Opening (Ex+)
        短いからと好き放題置いた譜面。BGもよろしくお願いします。
        
        Zazaburi Daisakusen (Lawless Ex+)
        ボム多いって言われたので壁を代わりに置きました。安心させたところで後でボムが出てくる割と好き放題置いた譜面。
        
        cat's magic☆ (Lawless Ex+)
        ボムポールで好き放題置いた譜面。ボムリセのボムとノーツの間隔めちゃくちゃ短いです。
        
        Cheap Trap (Ex+)
        この中で多分一番普通の第3回JBSLの譜面。
        
        Kurenai Fubuki (Lawless Ex+)
        ポール練習に作った譜面。今でもSS難しい。
        
        Won't Stop, Just Go! ...for Green Forest (Lawless Ex+)
        スピード感あるボム譜面。
</pre>
    </p>
    <h3>Headlines</h3>
    {% for headline in headlines %}
        <ul>
            <li>
                {% if headline.player != None %}
                    <a href="{% url 'app:userpage' sid=headline.player.sid %}">
                        <img src="{{ headline.player.imageURL }}" class="icon" />
                    </a> {{ headline.text }} （{{ headline.time }}）
                {% else %}
                    {{ headline.text }}
                {% endif %}
            </li>
        </ul>
    {% endfor %}
    <p>
        <a href="{% url 'app:headlines' page=1 %}">...More Headlines</a>
    </p>
    <h3>Live Leagues</h3>
    <table class="table table-striped table-borderless"
           style="background: rgba(255,255,255,.5)">
        <thead>
            <th>Cover</th>
            <th>Title</th>
            <th>Description</th>
            <th>Limit</th>
            <th>Owner</th>
            <th>End</th>
            <th>1st</th>
            <th>2nd</th>
            <th>
                3rd
            </th>
        </thead>
        {% for league in active_leagues %}
            <tr style="background:linear-gradient(to right, {{ league.color }}, rgba(0,0,0,0));">
                <td>
                    <a href={% url 'app:leaderboard' pk=league.pk %}>
                        <img class="thumb" src=" {{ league.playlist.image }}" />
                    </a>
                </td>
                <td>
                    {{ league.name }}
                </td>
                <td>
                    {{ league.description|truncatechars:50 }}
                </td>
                <td>
                    {% if league.isPublic %}
                        {% if league.limit == 2000 %}
                            上限なし
                        {% else %}
                            {{ league.limit }}
                        {% endif %}
                    {% else %}
                        Private
                    {% endif %}
                </td>
                <td>
                    <a href
                       {% url 'app:userpage' sid=league.owner.sid %}
                       style="color:black">{{ league.owner.name }}</a>
                </td>
                <td>
                    {{ league.end }}
                </td>
                <td>
                    {% if league.first != None %}
                        <a href="{% url 'app:userpage' sid=league.first.sid %}"
                           style="color:black">
                            {% with league.first as player %}
                                <img class="icon" src={{ player.imageURL }}>
                                <br>
                                {% if player.isSupporter %}
                                    <span style="color:{{ player.userColor }}; font-weight:bold; {% if player.isShadow %}filter: drop-shadow(0 0 3px {{ player.bgColor }});{% endif %} ">{{ player.name }}</span>
                                {% else %}
                                    {{ player.name }}
                                {% endif %}
                            {% endwith %}
                        </a>
                    {% endif %}
                </td>
                <td>
                    {% if league.second != None %}
                        <a href="{% url 'app:userpage' sid=league.second.sid %}"
                           style="color:black">
                            {% with league.second as player %}
                                <img class="icon" src={{ player.imageURL }}>
                                <br>
                                {% if player.isSupporter %}
                                    <span style="color:{{ player.userColor }}; font-weight:bold; {% if player.isShadow %}filter: drop-shadow(0 0 3px {{ player.bgColor }});{% endif %} ">{{ player.name }}</span>
                                {% else %}
                                    {{ player.name }}
                                {% endif %}
                            {% endwith %}
                        </a>
                    {% endif %}
                </td>
                <td>
                    {% if league.third != None %}
                        <a href="{% url 'app:userpage' sid=league.third.sid %}"
                           style="color:black">
                            {% with league.third as player %}
                                <img class="icon" src={{ player.imageURL }}>
                                <br>
                                {% if player.isSupporter %}
                                    <span style="color:{{ player.userColor }}; font-weight:bold; {% if player.isShadow %}filter: drop-shadow(0 0 3px {{ player.bgColor }});{% endif %} ">{{ player.name }}</span>
                                {% else %}
                                    {{ player.name }}
                                {% endif %}
                            {% endwith %}
                        </a>
                    {% endif %}
                </td>
            </tr>
        {% endfor %}
    </table>
{% endblock %}
