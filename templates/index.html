{% extends "base.html" %}
{% load static %}
{% load humanize %}
{% block content %}
    {% if user.player.isActivated and not user.player.inDiscord %}
        <div style="text-align:center">
            <h3>! Discord サーバー参加へのお願い !</h3>
            <p>
                あなたはまだ JBSL の Discord サーバーに参加していません。
            </p>
            <p>
                以下のリンクから参加お願いします。
            </p>
            <p>
                <span class="dl_link"><a href="https://discord.gg/CqQ6ZD8KRn">参加</a></span>
            </p>
        </div>
    {% endif %}
    {% for league in invitations %}
        <div style="text-align:center">
            <h3>
                ! リーグ <a href="{% url 'app:leaderboard' pk=league.pk %}"
    style="color:{{ league.color }}">{{ league }}</a> から招待が届いています !
                <form method="post">
                    {% csrf_token %}
                    <button class="btn" type="submit" name="join" value="{{ league.pk }}">参加</button>
                    <button class="btn"
                            style="background-color:red"
                            type="submit"
                            name="decline"
                            value="{{ league.pk }}">拒否</button>
                </form>
            </h3>
        </div>
    {% endfor %}
    {% if not user.is_authenticated %}
        <div style="text-align:center">
            <h3>Welcome to JBSL-Web!</h3>
            <h3>
                <a href="{% url 'app:info' pk=1 %}" style="color:ff8628">JBSL とは？</a>
            </h3>
        </div>
    {% endif %}
    <h3 style="text-align:center"><a href="{% url 'app:leaderboard' pk=42 %}" style="color:#ff8628">J1予選</a>開催中！</h3>
    <h3>特設 Q & A！</h3>
    <h4>Q、予選はいつ終わるの？</h4>
    <p style="margin:20px">
        J1 が終わるのは 11/6（日）23:59だよ！
    </p>
    <h4>Q、どうやって参加するの？</h4>
    <p style="margin:20px">
        <a href="{% url 'app:info' pk=3 %}" style="color:ff8628">プレイヤー登録</a>をした後で、リーグ開始後に<a href="{% url 'app:info' pk=4 %}" style="color:ff8628">リーグ参加</a>をしてね！
    </p>
    <h4 style="margin-left:50px">
        →より詳細は <a href="{% url 'app:info' pk=7 %}" style="color:ff8628">Q & A 詳細バージョン</a> へ
    </h4>
    <h3>マッパー杯開催中！</h3>
    <h4><a href="{% url 'app:leaderboard' pk=43 %}" style="color:#ff8628">Ge2toro 杯</a></h4>
    <p>マッパーさんよりコメントを頂いております。</p>
    <img src="https://cdn.scoresaber.com/avatars/76561198448239348.jpg" height="128px">
    <pre class="balloon">
    Calliope Mori ft. BOOGEY VOXX - Graveyard Shift
    ダンス譜面です！
    
    Camellia - Hiasobi ft Hatsune Miku (Play With Fire)
    ダンス譜面です！
    
    Garakuta Doll Play (Tanger Remix)
    ダンス譜面です！
    
    PURPLE KISS - Nerdy
    ダンス譜面です！
    
    Mitchie M (Project SEKAI) - Tokugawa Cup Noodle Kinshirei
    カップヌードルです！
    
    Kizuna AI x Tomari Mari - identity
    女児です！
    
    NORITZ - Ofuro ga Wakimashita
    お風呂が沸きました
    </pre>
    <h4><a href="{% url 'app:leaderboard' pk=44 %}" style="color:#ff8628">Soba`s 杯</a></h4>
    <p>マッパーさんよりコメントを頂いております。</p>
    <img src="https://cdn.beatsaver.com/avatar/292320888072830977.png" height="128px">
    <pre class="balloon">
    Nothing But Requiem with.Museo - Pentiment Ex+
    -
    かめりあ - t/a/n/a/s/i/n/n Ex+
    オリジナルそば風のスピード譜面
    Laur - Sound Chimera Ex+
    そばマップのくせに切りやすい
    USAO - Climax Ex+
    曲がかっこよくてすごく楽しい
    かめりあ - #1f1e33 Ex+
    Zeonさんとコラボ譜面
    しーけー - Nirv lucE H
    初心者も達成感あり曲も明るい
    NA - RAK ! E
    韓国の配信ミーム
    </pre>
    <h3>Headlines</h3>
    {% for headline in headlines %}
        <ul>
            <li>
                {% if headline.player != None %}
                    <a href="{% url 'app:userpage' sid=headline.player.sid %}">
                        <img src="{{ headline.player.imageURL }}" class="icon" />
                    </a> {{ headline.text }} （{{ headline.time }}）
                {% else %}
                    {{ headline.text }}
                {% endif %}
            </li>
        </ul>
    {% endfor %}
    <p>
        <a href="{% url 'app:headlines' page=1 %}">...More Headlines</a>
    </p>
    <h3>Live Leagues</h3>
    <table class="table table-striped table-borderless"
           style="background: rgba(255,255,255,.5)">
        <thead>
            <th>Cover</th>
            <th>Title</th>
            <th>Description</th>
            <th>Limit</th>
            <th>Owner</th>
            <th>End</th>
            <th>1st</th>
            <th>2nd</th>
            <th>3rd</th>
        </thead>
        {% for league in active_leagues %}
            <tr style="background:linear-gradient(to right, {{ league.color }}, rgba(0,0,0,0));">
                <td>
                    <a href={% url 'app:leaderboard' pk=league.pk %}>
                        <img class="thumb" src=" {{ league.playlist.image }}" />
                    </a>
                </td>
                <td>
                    {{ league.name }}
                    {% if league.isOfficial %}
                        <img src="{% static 'Check.png' %}" height="25px"/>
                    {% endif %}
                </td>
                <td>
                    {{ league.description|truncatechars:50 }}
                </td>
                <td>
                    {% if league.isPublic %}
                        {% if league.limit == 2000 %}
                            上限なし
                        {% else %}
                            {{ league.limit }}
                        {% endif %}
                    {% else %}
                        Private
                    {% endif %}
                </td>
                <td>
                    <a href
                       {% url 'app:userpage' sid=league.owner.sid %}
                       style="color:black">{{ league.owner.name }}</a>
                </td>
                <td>
                    {{ league.end }}
                </td>
                <td>
                    {% if league.first != None %}
                        <a href="{% url 'app:userpage' sid=league.first.sid %}"
                           style="color:black">
                            {% with league.first as player %}
                                <img class="icon" src={{ player.imageURL }}>
                                <br>
                                {% if player.isSupporter %}
                                    <span style="color:{{ player.userColor }}; font-weight:bold; {% if player.isShadow %}filter: drop-shadow(0 0 3px {{ player.bgColor }});{% endif %} ">{{ player.name }}</span>
                                {% else %}
                                    {{ player.name }}
                                {% endif %}
                            {% endwith %}
                        </a>
                    {% endif %}
                </td>
                <td>
                    {% if league.second != None %}
                        <a href="{% url 'app:userpage' sid=league.second.sid %}"
                           style="color:black">
                            {% with league.second as player %}
                                <img class="icon" src={{ player.imageURL }}>
                                <br>
                                {% if player.isSupporter %}
                                    <span style="color:{{ player.userColor }}; font-weight:bold; {% if player.isShadow %}filter: drop-shadow(0 0 3px {{ player.bgColor }});{% endif %} ">{{ player.name }}</span>
                                {% else %}
                                    {{ player.name }}
                                {% endif %}
                            {% endwith %}
                        </a>
                    {% endif %}
                </td>
                <td>
                    {% if league.third != None %}
                        <a href="{% url 'app:userpage' sid=league.third.sid %}"
                           style="color:black">
                            {% with league.third as player %}
                                <img class="icon" src={{ player.imageURL }}>
                                <br>
                                {% if player.isSupporter %}
                                    <span style="color:{{ player.userColor }}; font-weight:bold; {% if player.isShadow %}filter: drop-shadow(0 0 3px {{ player.bgColor }});{% endif %} ">{{ player.name }}</span>
                                {% else %}
                                    {{ player.name }}
                                {% endif %}
                            {% endwith %}
                        </a>
                    {% endif %}
                </td>
            </tr>
        {% endfor %}
    </table>
{% endblock %}
