{% load static %}
<head>
    <link rel="stylesheet"
          href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css"
          integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3"
          crossorigin="anonymous">
    <link rel="stylesheet" href="{% static 'style.css' %}">
    <title>JBSL</title>
    <meta property="og:title" content="JapanBeatSaberLeague" />
    <meta property="og:type" content="website" />
    <meta property="og:description"
          content="日本のプレイヤー同士でビートセイバーの総合的な実力を競い合う大会です！"/>
    <meta property="og:site_name" content="JapanBeatSaberLeague" />
    <meta property="og:url" content="{{ request.build_absolute_uri }}" />
    <meta property="og:image" content="{% static 'card.png' %}" />
    <meta name="twitter:card" content="{% static 'card.png' %}">
    <meta name="twitter:site" content="@115_jbsl">
</head>
<div class="match-border" style="color:red">
    <div class="match-title">Match1</div>
    <div class="match-player1" id="player1">Player1</div>
    <div class="match-result1">Result1</div>
    <div class="match-bomb1">B1</div>
    <div class="match-player2" id="player2">Player2</div>
    <div class="match-result2">Result2</div>
    <div class="match-bomb2">B2</div>
    <div class="match-image">
        <img src="" id="imageURL" height="256" width="256">
    </div>
    <div class="match-info" style="line-height:40px">
        <p id="map_info1">
            MAP Info
        </p>
        <p id="map_info2">
            MAP Info
        </p>
        <p id="map_info3">
            MAP Info
        </p>
        <p id="map_info4">
            MAP Info
        </p>
    </div>
</div>
</div>
<div class="coordinator">
    <p>
        この部分はコーディネーター用の調整領域になります
    </p>
    <p>
        ブラウザソースでは、この部分は表示されません
    </p>
    <form method="POST">
        {% csrf_token %}
        <P>
            Per Fight
        </p>
        <p>
            Per Map
        </p>
        <p>
            Now playing Map
            <input text>
        </p>
        <p>
            <b>Per Match</b>
        </p>
        <p>
            <Label>Match Title</Label>
            :
            <input text>
        </p>
        <p>
            <Label>Left Player (Player 1)</Label>
            :
            <input text>
        </p>
        <p>
            <Label>Right Player (Player 2)</Label>
            :
            <input text>
        </p>
        <p>
            <button>send</button>
        </p>
    </form>
</div>
<script>
    window.onload = function(){
        console.log('loaded');
    }

    function update(data){
        // console.log(data);
        document.getElementById("player1").innerHTML = data['player1'];
        document.getElementById("player2").innerHTML = data['player2'];
        var old_imageURL = document.getElementById("imageURL").src;
        var new_imageURL = data['imageURL'];
        if(old_imageURL != new_imageURL){
            console.log("change!");
            document.getElementById("imageURL").src = data['imageURL'];
        }
    }

    setInterval(function () {
        var url = "/match/api/" + {{ pk }};
        const response = fetch(url).
        then(response => response.json()).
        then(data => update(data));
    }, 500);
</script>
